<div class="transaction-container">
  <main class="p-3 p-md-4 bg-dark text-white flex-fill">
    <div class="container-fluid">
      <!-- Header -->
      <div
        class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2"
      >
        <h2 class="mb-0 fs-4">Transaction History</h2>
        <div class="d-flex gap-2">
          <button
            pButton
            label="Refresh"
            icon="pi pi-refresh"
            class="p-button-sm p-button-primary"
            (click)="getTransactions()"
          ></button>
          <button
            pButton
            label="Delete All"
            icon="pi pi-trash"
            class="p-button-sm p-button-danger"
            (click)="deleteAllTransactions()"
          ></button>
        </div>
      </div>

      <!-- Table -->
      <p-table
        [value]="transactions"
        [paginator]="true"
        [rows]="5"
        [rowsPerPageOptions]="[5,10,20]"
        responsiveLayout="scroll"
        [tableStyle]="{ 'min-width': '60rem' }"
      >
        <!-- Header -->
        <ng-template pTemplate="header">
          <tr>
            <th>Seial number</th>
            <th>Date</th>
            <th>Type</th>
            <th>Amount</th>
            <th>Name</th>
            <th>Phone</th>
            <th>Action</th>
          </tr>
        </ng-template>

        <!-- Body -->
        <ng-template pTemplate="body" let-txn let-i="rowIndex">
          <tr>
            <td>{{ i + 1 }}</td>
            <td>{{ txn.transactionDate | date: 'dd/MM/yyyy, hh:mm a' }}</td>
            <td>
              <p-badge
                [value]="txn.transactionType === 'credit' ? 'Received' : 'Sent'"
                [severity]="txn.transactionType === 'credit' ? 'success' : 'danger'"
              ></p-badge>
            </td>
            <td>
              <span
                [ngClass]="{
                'text-success': txn.transactionType === 'credit',
                'text-danger': txn.transactionType === 'debit',
                'fw-bold': true
              }"
              >
                {{ txn.transactionType === 'credit' ? '+' : '-' }}â‚¹ {{
                txn.transferAmount | number: '1.2-2' }}
              </span>
            </td>
            <td>{{ txn.receiverName || 'Unknown' }}</td>
            <td>
              <p-tag
                [value]="txn.receiverPhoneNumber || 'N/A'"
                severity="info"
              ></p-tag>
            </td>
            <td>
              <button
                pButton
                icon="pi pi-trash"
                class="p-button-sm p-button-danger p-button-rounded"
                (click)="deleteTransaction(txn.transactionId)"
              >
                Delete
              </button>
            </td>
          </tr>
        </ng-template>

        <!-- Empty -->
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="7" class="text-center text-muted">
              No transactions found.
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </main>
</div>
